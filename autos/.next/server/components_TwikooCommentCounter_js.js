"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "components_TwikooCommentCounter_js";
exports.ids = ["components_TwikooCommentCounter_js"];
exports.modules = {

/***/ "./components/TwikooCommentCounter.js":
/*!********************************************!*\
  !*** ./components/TwikooCommentCounter.js ***!
  \********************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _lib_config__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/config */ \"./lib/config.js\");\n/* harmony import */ var _lib_global__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/global */ \"./lib/global.js\");\n/* harmony import */ var _lib_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/utils */ \"./lib/utils/index.js\");\n/* harmony import */ var next_router__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next/router */ \"./node_modules/next/router.js\");\n/* harmony import */ var next_router__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(next_router__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! react */ \"react\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_4__);\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_lib_config__WEBPACK_IMPORTED_MODULE_0__, _lib_global__WEBPACK_IMPORTED_MODULE_1__]);\n([_lib_config__WEBPACK_IMPORTED_MODULE_0__, _lib_global__WEBPACK_IMPORTED_MODULE_1__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\n\n\n/**\n * 获取博客的评论数，用与在列表中展示\n * @returns {JSX.Element}\n * @constructor\n */ const TwikooCommentCounter = (props)=>{\n    let commentsData = [];\n    const { theme } = (0,_lib_global__WEBPACK_IMPORTED_MODULE_1__.useGlobal)();\n    const router = (0,next_router__WEBPACK_IMPORTED_MODULE_3__.useRouter)();\n    (0,react__WEBPACK_IMPORTED_MODULE_4__.useEffect)(()=>{\n        // console.log('路由触发评论计数')\n        if (props?.posts && props?.posts?.length > 0) {\n            fetchTwikooData(props.posts);\n        }\n    }, [\n        router.events\n    ]);\n    // 监控主题变化时的的评论数\n    (0,react__WEBPACK_IMPORTED_MODULE_4__.useEffect)(()=>{\n        // console.log('主题触发评论计数', commentsData)\n        updateCommentCount();\n    }, [\n        theme\n    ]);\n    const twikooCDNURL = (0,_lib_config__WEBPACK_IMPORTED_MODULE_0__.siteConfig)(\"COMMENT_TWIKOO_CDN_URL\");\n    const twikooENVID = (0,_lib_config__WEBPACK_IMPORTED_MODULE_0__.siteConfig)(\"COMMENT_TWIKOO_ENV_ID\");\n    /**\n   * 加载外部twikoojs\n   * @param {*} posts\n   */ const fetchTwikooData = async (posts)=>{\n        posts.forEach((post)=>{\n            post.slug = post.slug.startsWith(\"/\") ? post.slug : `/${post.slug}`;\n        });\n        try {\n            await (0,_lib_utils__WEBPACK_IMPORTED_MODULE_2__.loadExternalResource)(twikooCDNURL, \"js\");\n            const twikoo = window.twikoo;\n            twikoo.getCommentsCount({\n                envId: twikooENVID,\n                // region: 'ap-guangzhou', // 环境地域，默认为 ap-shanghai，如果您的环境地域不是上海，需传此参数\n                urls: posts?.map((post)=>post.slug),\n                includeReply: true // 评论数是否包括回复，默认：false\n            }).then(function(res) {\n                commentsData = res;\n                updateCommentCount();\n            }).catch(function(err) {\n                // 发生错误\n                console.error(err);\n            });\n        } catch (error) {\n            console.error(\"twikoo 加载失败\", error);\n        }\n    };\n    const updateCommentCount = ()=>{\n        if (commentsData.length === 0) {\n            return;\n        }\n        props.posts.forEach((post)=>{\n            const matchingRes = commentsData.find((r)=>r.url === post.slug);\n            if (matchingRes) {\n                // 修改评论数量div\n                const textElements = document.querySelectorAll(`.comment-count-text-${post.id}`);\n                textElements.forEach((element)=>{\n                    element.innerHTML = matchingRes.count;\n                });\n                // 取消隐藏\n                const wrapperElements = document.querySelectorAll(`.comment-count-wrapper-${post.id}`);\n                wrapperElements.forEach((element)=>{\n                    element.classList.remove(\"hidden\");\n                });\n            }\n        });\n    };\n    return null;\n};\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (TwikooCommentCounter);\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9jb21wb25lbnRzL1R3aWtvb0NvbW1lbnRDb3VudGVyLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQXlDO0FBQ0Q7QUFDVTtBQUNYO0FBQ047QUFFakM7Ozs7Q0FJQyxHQUVELE1BQU1LLHVCQUF1QixDQUFDQztJQUM1QixJQUFJQyxlQUFlLEVBQUU7SUFDckIsTUFBTSxFQUFFQyxLQUFLLEVBQUUsR0FBR1Asc0RBQVNBO0lBQzNCLE1BQU1RLFNBQVNOLHNEQUFTQTtJQUV4QkMsZ0RBQVNBLENBQUM7UUFDUiwwQkFBMEI7UUFDMUIsSUFBSUUsT0FBT0ksU0FBU0osT0FBT0ksT0FBT0MsU0FBUyxHQUFHO1lBQzVDQyxnQkFBZ0JOLE1BQU1JLEtBQUs7UUFDN0I7SUFDRixHQUFHO1FBQUNELE9BQU9JLE1BQU07S0FBQztJQUVsQixlQUFlO0lBQ2ZULGdEQUFTQSxDQUFDO1FBQ1Isd0NBQXdDO1FBQ3hDVTtJQUNGLEdBQUc7UUFBQ047S0FBTTtJQUVWLE1BQU1PLGVBQWVmLHVEQUFVQSxDQUFDO0lBQ2hDLE1BQU1nQixjQUFjaEIsdURBQVVBLENBQUM7SUFFL0I7OztHQUdDLEdBQ0QsTUFBTVksa0JBQWtCLE9BQU9GO1FBQzdCQSxNQUFNTyxPQUFPLENBQUNDLENBQUFBO1lBQ1pBLEtBQUtDLElBQUksR0FBR0QsS0FBS0MsSUFBSSxDQUFDQyxVQUFVLENBQUMsT0FBT0YsS0FBS0MsSUFBSSxHQUFHLENBQUMsQ0FBQyxFQUFFRCxLQUFLQyxJQUFJLENBQUMsQ0FBQztRQUNyRTtRQUNBLElBQUk7WUFDRixNQUFNakIsZ0VBQW9CQSxDQUFDYSxjQUFjO1lBQ3pDLE1BQU1NLFNBQVNDLE9BQU9ELE1BQU07WUFDNUJBLE9BQU9FLGdCQUFnQixDQUFDO2dCQUN0QkMsT0FBT1I7Z0JBQ1AscUVBQXFFO2dCQUNyRVMsTUFBTWYsT0FBT2dCLElBQUlSLENBQUFBLE9BQVFBLEtBQUtDLElBQUk7Z0JBQ2xDUSxjQUFjLEtBQUsscUJBQXFCO1lBQzFDLEdBQUdDLElBQUksQ0FBQyxTQUFVQyxHQUFHO2dCQUNuQnRCLGVBQWVzQjtnQkFDZmY7WUFDRixHQUFHZ0IsS0FBSyxDQUFDLFNBQVVDLEdBQUc7Z0JBQ3BCLE9BQU87Z0JBQ1BDLFFBQVFDLEtBQUssQ0FBQ0Y7WUFDaEI7UUFDRixFQUFFLE9BQU9FLE9BQU87WUFDZEQsUUFBUUMsS0FBSyxDQUFDLGVBQWVBO1FBQy9CO0lBQ0Y7SUFFQSxNQUFNbkIscUJBQXFCO1FBQ3pCLElBQUlQLGFBQWFJLE1BQU0sS0FBSyxHQUFHO1lBQzdCO1FBQ0Y7UUFDQUwsTUFBTUksS0FBSyxDQUFDTyxPQUFPLENBQUNDLENBQUFBO1lBQ2xCLE1BQU1nQixjQUFjM0IsYUFBYTRCLElBQUksQ0FBQ0MsQ0FBQUEsSUFBS0EsRUFBRUMsR0FBRyxLQUFLbkIsS0FBS0MsSUFBSTtZQUM5RCxJQUFJZSxhQUFhO2dCQUNmLFlBQVk7Z0JBQ1osTUFBTUksZUFBZUMsU0FBU0MsZ0JBQWdCLENBQUMsQ0FBQyxvQkFBb0IsRUFBRXRCLEtBQUt1QixFQUFFLENBQUMsQ0FBQztnQkFDL0VILGFBQWFyQixPQUFPLENBQUN5QixDQUFBQTtvQkFDbkJBLFFBQVFDLFNBQVMsR0FBR1QsWUFBWVUsS0FBSztnQkFDdkM7Z0JBQ0EsT0FBTztnQkFDUCxNQUFNQyxrQkFBa0JOLFNBQVNDLGdCQUFnQixDQUFDLENBQUMsdUJBQXVCLEVBQUV0QixLQUFLdUIsRUFBRSxDQUFDLENBQUM7Z0JBQ3JGSSxnQkFBZ0I1QixPQUFPLENBQUN5QixDQUFBQTtvQkFDdEJBLFFBQVFJLFNBQVMsQ0FBQ0MsTUFBTSxDQUFDO2dCQUMzQjtZQUNGO1FBQ0Y7SUFDRjtJQUVBLE9BQU87QUFDVDtBQUVBLGlFQUFlMUMsb0JBQW9CQSxFQUFBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbm90aW9uLW5leHQvLi9jb21wb25lbnRzL1R3aWtvb0NvbW1lbnRDb3VudGVyLmpzP2Y1ZmYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgc2l0ZUNvbmZpZyB9IGZyb20gJ0AvbGliL2NvbmZpZydcbmltcG9ydCB7IHVzZUdsb2JhbCB9IGZyb20gJ0AvbGliL2dsb2JhbCdcbmltcG9ydCB7IGxvYWRFeHRlcm5hbFJlc291cmNlIH0gZnJvbSAnQC9saWIvdXRpbHMnXG5pbXBvcnQgeyB1c2VSb3V0ZXIgfSBmcm9tICduZXh0L3JvdXRlcidcbmltcG9ydCB7IHVzZUVmZmVjdCB9IGZyb20gJ3JlYWN0J1xuXG4vKipcbiAqIOiOt+WPluWNmuWuoueahOivhOiuuuaVsO+8jOeUqOS4juWcqOWIl+ihqOS4reWxleekulxuICogQHJldHVybnMge0pTWC5FbGVtZW50fVxuICogQGNvbnN0cnVjdG9yXG4gKi9cblxuY29uc3QgVHdpa29vQ29tbWVudENvdW50ZXIgPSAocHJvcHMpID0+IHtcbiAgbGV0IGNvbW1lbnRzRGF0YSA9IFtdXG4gIGNvbnN0IHsgdGhlbWUgfSA9IHVzZUdsb2JhbCgpXG4gIGNvbnN0IHJvdXRlciA9IHVzZVJvdXRlcigpXG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAvLyBjb25zb2xlLmxvZygn6Lev55Sx6Kem5Y+R6K+E6K666K6h5pWwJylcbiAgICBpZiAocHJvcHM/LnBvc3RzICYmIHByb3BzPy5wb3N0cz8ubGVuZ3RoID4gMCkge1xuICAgICAgZmV0Y2hUd2lrb29EYXRhKHByb3BzLnBvc3RzKVxuICAgIH1cbiAgfSwgW3JvdXRlci5ldmVudHNdKVxuXG4gIC8vIOebkeaOp+S4u+mimOWPmOWMluaXtueahOeahOivhOiuuuaVsFxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIC8vIGNvbnNvbGUubG9nKCfkuLvpopjop6blj5Hor4TorrrorqHmlbAnLCBjb21tZW50c0RhdGEpXG4gICAgdXBkYXRlQ29tbWVudENvdW50KClcbiAgfSwgW3RoZW1lXSlcblxuICBjb25zdCB0d2lrb29DRE5VUkwgPSBzaXRlQ29uZmlnKCdDT01NRU5UX1RXSUtPT19DRE5fVVJMJylcbiAgY29uc3QgdHdpa29vRU5WSUQgPSBzaXRlQ29uZmlnKCdDT01NRU5UX1RXSUtPT19FTlZfSUQnKVxuXG4gIC8qKlxuICAgKiDliqDovb3lpJbpg6h0d2lrb29qc1xuICAgKiBAcGFyYW0geyp9IHBvc3RzXG4gICAqL1xuICBjb25zdCBmZXRjaFR3aWtvb0RhdGEgPSBhc3luYyAocG9zdHMpID0+IHtcbiAgICBwb3N0cy5mb3JFYWNoKHBvc3QgPT4ge1xuICAgICAgcG9zdC5zbHVnID0gcG9zdC5zbHVnLnN0YXJ0c1dpdGgoJy8nKSA/IHBvc3Quc2x1ZyA6IGAvJHtwb3N0LnNsdWd9YFxuICAgIH0pXG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IGxvYWRFeHRlcm5hbFJlc291cmNlKHR3aWtvb0NETlVSTCwgJ2pzJylcbiAgICAgIGNvbnN0IHR3aWtvbyA9IHdpbmRvdy50d2lrb29cbiAgICAgIHR3aWtvby5nZXRDb21tZW50c0NvdW50KHtcbiAgICAgICAgZW52SWQ6IHR3aWtvb0VOVklELCAvLyDnjq/looMgSURcbiAgICAgICAgLy8gcmVnaW9uOiAnYXAtZ3Vhbmd6aG91JywgLy8g546v5aKD5Zyw5Z+f77yM6buY6K6k5Li6IGFwLXNoYW5naGFp77yM5aaC5p6c5oKo55qE546v5aKD5Zyw5Z+f5LiN5piv5LiK5rW377yM6ZyA5Lyg5q2k5Y+C5pWwXG4gICAgICAgIHVybHM6IHBvc3RzPy5tYXAocG9zdCA9PiBwb3N0LnNsdWcpLCAvLyDkuI3ljIXlkKvljY/orq7jgIHln5/lkI3jgIHlj4LmlbDnmoTmlofnq6Dot6/lvoTliJfooajvvIzlv4XkvKDlj4LmlbBcbiAgICAgICAgaW5jbHVkZVJlcGx5OiB0cnVlIC8vIOivhOiuuuaVsOaYr+WQpuWMheaLrOWbnuWkje+8jOm7mOiupO+8mmZhbHNlXG4gICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgY29tbWVudHNEYXRhID0gcmVzXG4gICAgICAgIHVwZGF0ZUNvbW1lbnRDb3VudCgpXG4gICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgIC8vIOWPkeeUn+mUmeivr1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycilcbiAgICAgIH0pXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ3R3aWtvbyDliqDovb3lpLHotKUnLCBlcnJvcilcbiAgICB9XG4gIH1cblxuICBjb25zdCB1cGRhdGVDb21tZW50Q291bnQgPSAoKSA9PiB7XG4gICAgaWYgKGNvbW1lbnRzRGF0YS5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBwcm9wcy5wb3N0cy5mb3JFYWNoKHBvc3QgPT4ge1xuICAgICAgY29uc3QgbWF0Y2hpbmdSZXMgPSBjb21tZW50c0RhdGEuZmluZChyID0+IHIudXJsID09PSBwb3N0LnNsdWcpXG4gICAgICBpZiAobWF0Y2hpbmdSZXMpIHtcbiAgICAgICAgLy8g5L+u5pS56K+E6K665pWw6YePZGl2XG4gICAgICAgIGNvbnN0IHRleHRFbGVtZW50cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYC5jb21tZW50LWNvdW50LXRleHQtJHtwb3N0LmlkfWApXG4gICAgICAgIHRleHRFbGVtZW50cy5mb3JFYWNoKGVsZW1lbnQgPT4ge1xuICAgICAgICAgIGVsZW1lbnQuaW5uZXJIVE1MID0gbWF0Y2hpbmdSZXMuY291bnRcbiAgICAgICAgfSlcbiAgICAgICAgLy8g5Y+W5raI6ZqQ6JePXG4gICAgICAgIGNvbnN0IHdyYXBwZXJFbGVtZW50cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYC5jb21tZW50LWNvdW50LXdyYXBwZXItJHtwb3N0LmlkfWApXG4gICAgICAgIHdyYXBwZXJFbGVtZW50cy5mb3JFYWNoKGVsZW1lbnQgPT4ge1xuICAgICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJylcbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICB9KVxuICB9XG5cbiAgcmV0dXJuIG51bGxcbn1cblxuZXhwb3J0IGRlZmF1bHQgVHdpa29vQ29tbWVudENvdW50ZXJcbiJdLCJuYW1lcyI6WyJzaXRlQ29uZmlnIiwidXNlR2xvYmFsIiwibG9hZEV4dGVybmFsUmVzb3VyY2UiLCJ1c2VSb3V0ZXIiLCJ1c2VFZmZlY3QiLCJUd2lrb29Db21tZW50Q291bnRlciIsInByb3BzIiwiY29tbWVudHNEYXRhIiwidGhlbWUiLCJyb3V0ZXIiLCJwb3N0cyIsImxlbmd0aCIsImZldGNoVHdpa29vRGF0YSIsImV2ZW50cyIsInVwZGF0ZUNvbW1lbnRDb3VudCIsInR3aWtvb0NETlVSTCIsInR3aWtvb0VOVklEIiwiZm9yRWFjaCIsInBvc3QiLCJzbHVnIiwic3RhcnRzV2l0aCIsInR3aWtvbyIsIndpbmRvdyIsImdldENvbW1lbnRzQ291bnQiLCJlbnZJZCIsInVybHMiLCJtYXAiLCJpbmNsdWRlUmVwbHkiLCJ0aGVuIiwicmVzIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwiZXJyb3IiLCJtYXRjaGluZ1JlcyIsImZpbmQiLCJyIiwidXJsIiwidGV4dEVsZW1lbnRzIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiaWQiLCJlbGVtZW50IiwiaW5uZXJIVE1MIiwiY291bnQiLCJ3cmFwcGVyRWxlbWVudHMiLCJjbGFzc0xpc3QiLCJyZW1vdmUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./components/TwikooCommentCounter.js\n");

/***/ })

};
;